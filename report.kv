MDScreen:
    name: "report"

    BoxLayout:
        orientation: "vertical"
        padding: dp(10)
        spacing: dp(10)

        # Back Arrow and Title on the Same Row
        BoxLayout:
            orientation: "horizontal"
            size_hint_y: None
            height: dp(40)

            # Back Button (left aligned)
            MDIconButton:
                icon: "arrow-left"
                pos_hint: {"center_y": 0.5}
                on_release:
                    app.switch_to_screen('home')
                    app.stop_camera()

            Widget:
                size_hint_x: None
                width: dp(25)

            MDLabel:
                text: "Report an Accident"
                font_style: "H5"
                halign: "left"
                pos_hint: {"center_y": 0.5}
                size_hint_y: None
                height: dp(20)

        Widget:
            size_hint_x: None
            width: dp(5)

        # Person Photo Section
        BoxLayout:
            orientation: "horizontal"
            size_hint_y: None
            #pos_hint: {"center_y": 0.1}
            padding: [0, 10, 0, 0]  # [left, top, right, bottom] padding
            height: dp(200)

            MDCard:
                orientation: 'vertical'
                size_hint: None, None
                size: dp(200), dp(200)
                padding: dp(10)
                radius: [5, 5, 5, 5]
                elevation: 5

                MDLabel:
                    text: "Person's Photo"
                    halign: "center"
                    size_hint_y: None
                    height: dp(20)

                Image:
                    id: photo_holder
                    source: 'placeholder_image.png'
                    allow_stretch: True
                    keep_ratio: True

            Widget:
                size_hint_x: None
                width: dp(10)

            BoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: dp(100)

                MDFillRoundFlatButton:
                    text: "Get Photo"
                    pos_hint: {"center_y": 0.2}
                    size_hint_x: 0.8  # Set width proportionally to the parent
                    on_release: app.start_camera()

                Widget:
                    size_hint_x: None
                    width: dp(5)

                MDFillRoundFlatButton:
                    text: "Upload"
                    pos_hint: {"center_y": 0.2}
                    size_hint_x: 0.8  # Set width proportionally to the parent
                    on_release: app.capture_photo()

                #Widget:
                   # size_hint_x: None
                    #width: dp(10)

                #MDFillRoundFlatButton:
                    #text: "Stop Camera"
                    #pos_hint: {"center_y": 0.2}
                    #on_release: app.stop_camera()

        # Data filling section
        BoxLayout:
            orientation: "vertical"
            size_hint_y: None
            height: dp(200)
            BoxLayout:
                orientation: "horizontal"
                size_hint_y: None
                height: dp(60)
                MDLabel:
                    text: "Accident Type"
                    halign: "left"
                    size_hint_x: 0.4
                    size_hint_y: None
                    height: dp(20)

                Widget:
                    size_hint_x: None
                    width: dp(5)

                # BoxLayout to hold the Spinner and the icon
                BoxLayout:
                    orientation: "horizontal"
                    size_hint_x: 0.6
                    height: dp(40)

                    MDTextField:
                        id: accident_field
                        hint_text: "Select Accident Type"
                        size_hint_x: 0.6
                        height: dp(40)
                        pos_hint: {"center_y": 0.2}
                        #on_focus: if self.focus: app.menu_accident.open()

                    # Icon to simulate dropdown arrow
                    MDIconButton:
                        icon: "arrow-down-drop-circle"
                        size_hint_x: 0.15  # Adjust size of the icon area
                        pos_hint: {"center_y": 0.2}
                        on_release: app.menu_accident.open()  # Trigger the dropdown when the icon is clicked

            BoxLayout:
                orientation: "horizontal"
                size_hint_y: None
                height: dp(60)

                MDLabel:
                    text: "No of Injuries"
                    halign: "left"
                    size_hint_x: 0.4
                    size_hint_y: None
                    height: dp(20)

                Widget:
                    size_hint_x: None
                    width: dp(5)

                # BoxLayout to hold the Spinner and the icon
                BoxLayout:
                    orientation: "horizontal"
                    size_hint_x: 0.6
                    height: dp(40)

                    Spinner:
                        id: injured_count_spinner
                        hint_text: "Number of injuries"
                        icon:"arrow-down-drop-circle"
                        values: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10','11', '12', '13', '14', '15', '16', '17', '18', '19', '20']  # Adjust the range as needed
                        size_hint_x: 0.60  #adjust width of the box
                        height: dp(10)
                        pos_hint: {"center_y": 0.2}
                        on_text: app.on_injured_count_selected(self.text)
                        background_color: 1, 1, 1, 1  # RGBA values for white
                        background_normal: ""  # Removes the default background image
                        color: 0, 0, 0, 1  # RGBA values for black


                    # Icon to simulate dropdown arrow
                    MDIconButton:
                        icon: "arrow-down-drop-circle"
                        size_hint_x: 0.15  # Adjust size of the icon area
                        pos_hint: {"center_y": 0.2}
                        on_release: injured_count_spinner.trigger_action(0)  # Trigger the dropdown when the icon is clicked



            BoxLayout:
                orientation: "horizontal"
                size_hint_y: None
                height: dp(60)

                MDLabel:
                    text: "Person's Status"
                    halign: "left"
                    size_hint_x: 0.4
                    size_hint_y: None
                    height: dp(20)

                Widget:
                    size_hint_x: None
                    width: dp(5)

                # BoxLayout to hold the Spinner and the icon
                BoxLayout:
                    orientation: "horizontal"
                    size_hint_x: 0.6
                    height: dp(40)

                    MDTextField:
                        id: persons_status_field
                        hint_text: "Select Status"
                        size_hint_x: 0.6
                        height: dp(40)
                        pos_hint: {"center_y": 0.2}
                        #on_focus: if self.focus: app.menu_person_status.open()

                    # Icon to simulate dropdown arrow
                    MDIconButton:
                        icon: "arrow-down-drop-circle"
                        size_hint_x: 0.15  # Adjust size of the icon area
                        pos_hint: {"center_y": 0.2}
                        on_release: app.menu_person_status.open()  # Trigger the dropdown when the icon is clicked

        Widget:
            size_hint_x: None
            width: dp(20)

        MDFillRoundFlatButton:
            text: "Next"
            pos_hint: {"center_x": 0.5}
            on_release: app.switch_to_screen('track_location')  # Switch to 'track_location' screen
